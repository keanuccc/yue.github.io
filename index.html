<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>To æ¨¾æ¨¾: My Exclusive Planet</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&family=Noto+Serif+SC:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

    <style>
        /* --- 1. å…¨å±€å®šä¹‰ --- */
        :root {
            --primary-pink: #eec1cd; --deep-pink: #d4a5b0; --accent-red: #cc7a8b;
            --cream-bg: #fffbf0; --text-main: #5d4e52; --text-light: #9c8e92;
            --shadow-float: 0 10px 30px rgba(212, 165, 176, 0.2);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; outline: none; }
        
        html, body {
            position: relative; height: 100%; width: 100%;
            background-color: var(--cream-bg); font-family: 'Nunito', 'Noto Serif SC', serif;
            overflow: hidden; 
        }

        /* --- 2. å¸ƒå±€æ ¸å¿ƒ (æ‰‹æœºé€‚é…å…³é”®) --- */
        .swiper-container { width: 100%; height: 100%; }
        .swiper-slide {
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            overflow: hidden; position: relative; width: 100%;
        }

        .safe-container {
            width: 88vw; 
            max-width: 420px;
            margin: 0 auto;
            display: flex; flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 10;
        }

        /* --- 3. ç¬¬ä¸€å± (é¦–é¡µ) --- */
        #slide1 { background: radial-gradient(circle at top right, #fff0f5, #fffbf0); }
        .hero-img { width: 130px; height: 130px; margin-bottom: 20px; border-radius: 50%; box-shadow: var(--shadow-float); }
        .hero-title { 
            font-size: clamp(1.6rem, 7vw, 2.2rem); 
            color: var(--accent-red); line-height: 1.4; margin-bottom: 15px; 
            text-align: center; width: 100%; word-break: break-all;
        }
        .timer-badge { 
            background: white; padding: 10px 20px; border-radius: 50px; 
            border: 1px solid #ffeef0; box-shadow: var(--shadow-float); 
            text-align: center; margin-top: 10px;
        }

        /* --- 4. ç¬¬äºŒå± (åˆ—è½¦) --- */
        #slide2 { background: linear-gradient(to bottom, #fff9fa 0%, #fff0f5 100%); }
        .express-container { width: 100%; height: 200px; margin: 20px 0; display: flex; align-items: center; justify-content: center; position: relative;}
        .train-wrapper { width: 100%; opacity: 0; transform: translateX(-100%); position: relative; }
        .train-img { width: 100%; display: block; filter: drop-shadow(0 10px 15px rgba(204, 122, 139, 0.2)); }
        
        .carriage-trigger { position: absolute; top: 20%; height: 60%; z-index: 10; cursor: pointer; }
        #c1 { left: 5%; width: 38%; }
        #c2 { left: 42%; width: 35%; }
        #c3 { left: 72%; width: 35%; }

        .cargo-modal { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); 
            width: 90%; background: rgba(255,255,255,0.98); border-radius: 20px; padding: 20px; 
            box-shadow: 0 25px 50px rgba(204, 122, 139, 0.3); border: 2px solid #fff; 
            z-index: 50; opacity: 0; transition: all 0.4s; pointer-events: none; text-align: center; 
        }
        .cargo-modal.show { transform: translate(-50%, -50%) scale(1); opacity: 1; pointer-events: auto; }
        
        #final-gift-btn { 
            padding: 12px 30px; background: var(--accent-red); color: white; border: none; 
            border-radius: 30px; font-weight: bold; box-shadow: 0 10px 20px rgba(204, 122, 139, 0.4); 
            opacity: 0; transform: translateY(20px); transition: all 0.5s; margin-top: 20px; pointer-events: none;
        }
        #final-gift-btn.show { opacity: 1; transform: translateY(0); pointer-events: auto; }

        /* --- [å…³é”®ä¿®æ”¹] 5. ç¬¬ä¸‰å± (æ˜Ÿç³» + ç¾é£Ÿå›å¿†èƒŒæ™¯) --- */
        #slide3 { position: relative; }
        /* ä½¿ç”¨ä¼ªå…ƒç´ æ·»åŠ èƒŒæ™¯å›¾ï¼Œå¹¶å åŠ ä¸€å±‚åŠé€æ˜è’™ç‰ˆï¼Œé˜²æ­¢å›¾ç‰‡å¤ªèŠ±å½±å“æ¸¸æˆ */
        #slide3::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('bg_final.jpg') center/cover no-repeat;
            opacity: 1; z-index: -2;
        }
        /* å åŠ å±‚ï¼šæŸ”å’Œçš„é®ç½©ï¼Œè®©èƒŒæ™¯éšçº¦å¯è§ä½†ä¸è¿‡åˆ†æŠ¢çœ¼ */
        #slide3::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 251, 240, 0.85); /* 85% ä¸é€æ˜åº¦çš„å¥¶æ²¹è‰² */
            z-index: -1;
        }

        .galaxy-header { margin-bottom: 50px; text-align: center; width: 100%; }
        .galaxy-wrap {
            position: relative; width: 280px; height: 280px; 
            display: flex; align-items: center; justify-content: center;
        }
        .orbit-ring { 
            position: absolute; width: 230px; height: 230px; 
            border: 1px dashed rgba(204, 122, 139, 0.3); border-radius: 50%; animation: spin 60s linear infinite; 
        }
        .core-planet img { width: 100px; height: 100px; border-radius: 50%; border: 4px solid white; box-shadow: 0 0 20px rgba(238,193,205,0.5); }
        .crystal { 
            position: absolute; width: 44px; height: 44px; background: rgba(255,255,255,0.95); 
            border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 20; 
        }
        .crystal span { font-size: 1.2rem; }
        .crystal p { font-size: 10px; color: #999; margin: -2px 0 0 0; transform: scale(0.85); }

        /* --- 6. ç¬¬å››å± (è·‘æ­¥) --- */
        #slide4 { position: relative; } 
        #slide4::before { content: ''; position: absolute; top:0; left:0; width:100%; height:100%; background: url('bg_passion.jpg') center/cover; opacity: 0.1; z-index: -1; }
        
        .glass-card { 
            width: 100%; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(10px); 
            border-radius: 20px; padding: 25px 20px; box-shadow: var(--shadow-float); text-align: left; 
        }
        .img-group { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .run-img { width: 40vw; max-width: 150px; height: auto; border-radius: 10px; border: 3px solid white; box-shadow: var(--shadow-float); }

        /* --- 7. ç¬¬äº”å± (ç”œèœœåˆå½±) --- */
        #slide-confession { background: radial-gradient(circle at center, #ffe6ea 0%, #fff0f5 100%); }
        .photo-card-wrap {
            background: white; padding: 10px 10px 30px 10px; border-radius: 4px;
            box-shadow: 0 15px 35px rgba(204, 122, 139, 0.25);
            transform: rotate(-3deg); margin-bottom: 20px; width: 100%;
        }
        .confession-img { width: 100%; height: auto; display: block; border-radius: 2px; }

        /* --- 8. æœ€åä¸€å± (ä¿¡ä»¶) --- */
        #slide5 { background: linear-gradient(180deg, #fffbf0 0%, #fff0f5 100%); }
        .letter-content p { margin: 10px 0; line-height: 1.6; font-size: 0.95rem; color: #555; text-align: justify; }
        .cat-img { width: 60px; height: 60px; position: absolute; bottom: -25px; right: -10px; border-radius: 50%; border: 3px solid white; box-shadow: var(--shadow-float); }

        /* --- åŠ¨ç”»ä¸æ§ä»¶ --- */
        .arrow-up { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 24px; animation: bounce 2s infinite; opacity: 0.6; z-index: 20; }
        @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translate(-50%, 0);} 40% {transform: translate(-50%, -10px);} 60% {transform: translate(-50%, -5px);} }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        
        [data-ani] { opacity: 0; }
        .animate__animated { opacity: 1 !important; }

        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fffbf0; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.5s; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--accent-red); border-radius: 50%; animation: spin 1s linear infinite; }
        
        #music-control { position: fixed; top: 20px; right: 20px; width: 36px; height: 36px; z-index: 1000; border-radius: 50%; background: rgba(255,255,255,0.8); border: 1px solid var(--deep-pink); display: flex; justify-content: center; align-items: center; animation: spin 4s linear infinite; animation-play-state: paused; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        #music-control.playing { animation-play-state: running; }
        
        #fireworks-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
        .confetti { position: absolute; width: 6px; height: 6px; border-radius: 50%; opacity: 0; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div class="spinner"></div>
        <p style="margin-top: 15px; color: #999; font-size: 0.8rem;">æ­£åœ¨å‡†å¤‡æƒŠå–œ...</p>
    </div>

    <div id="music-control">
        <svg viewBox="0 0 24 24" width="20" height="20" stroke="var(--accent-red)" stroke-width="2" fill="none">
            <path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle>
        </svg>
    </div>
    <audio id="bgm" loop preload="auto"><source src="https://music.163.com/song/media/outer/url?id=1459950258.mp3" type="audio/mpeg"></audio>

    <div class="swiper-container">
        <div class="swiper-wrapper">
            
            <div class="swiper-slide" id="slide1">
                <div class="safe-container">
                    <img src="img_bear.png" class="hero-img" data-ani="animate__zoomIn" alt="å°ç†Š">
                    <h1 class="hero-title" data-ani="animate__fadeInUp">ç¥æˆ‘æœ€å¯çˆ±çš„æ¨¾æ¨¾<br>æƒ…äººèŠ‚å¿«ä¹ï¼</h1>
                    <p style="color: var(--text-light); font-size: 0.9rem;" data-ani="animate__fadeInUp">ç³¯ç±³åŒ…æ±¤åœ†å’Œæˆ‘çš„ç¬¬ä¸€ä¸ªæƒ…äººèŠ‚</p>
                    <div class="timer-badge" data-ani="animate__fadeInUp">
                        <div style="font-size: 0.7rem; color: #999;">æˆ‘ä»¬å·²ç»ç”œèœœåœ¨çº¿</div>
                        <div id="love-timer" style="font-size: 1.1rem; font-weight: 800; color: var(--accent-red); margin: 5px 0;">...</div>
                        <div style="font-size: 0.7rem; color: #aaa;">Since 2026.01.31</div>
                    </div>
                </div>
                <div class="arrow-up"><svg viewBox="0 0 24 24" fill="#cc7a8b"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></div>
            </div>

            <div class="swiper-slide" id="slide2">
                <div class="safe-container">
                    <h2 data-ani="animate__fadeInDown" style="color: var(--accent-red); margin-bottom: 5px; font-size: 1.2rem;">ğŸš‚ å°ç†ŠäºŒå·Â·ä¸“åˆ—</h2>
                    <p id="train-tips" data-ani="animate__fadeIn" style="color: var(--text-light); font-size: 0.8rem;">ç‚¹å‡»è½¦å¢ï¼ŒæŸ¥æ”¶ä¸“å±è´§ç‰© (0/3)</p>
                    
                    <div class="express-container">
                        <div class="train-wrapper" id="train-wrapper">
                            <img src="img_train.png" class="train-img" alt="Train">
                            <div class="carriage-trigger" id="c1" onclick="openCarriage(1)"></div>
                            <div class="carriage-trigger" id="c2" onclick="openCarriage(2)"></div>
                            <div class="carriage-trigger" id="c3" onclick="openCarriage(3)"></div>
                        </div>
                        <div class="cargo-modal" id="cargo-modal">
                            <div style="position:absolute; top:5px; right:15px; font-size:1.5rem; color:#ccc;" onclick="closeModal()">Ã—</div>
                            <span id="modal-icon" style="font-size: 3rem; display:block; margin-bottom:10px;">ğŸ</span>
                            <div id="modal-title" style="color:var(--accent-red); font-weight:bold; margin-bottom:5px;"></div>
                            <div id="modal-desc" style="font-size:0.9rem; color:#666; line-height:1.4;"></div>
                        </div>
                    </div>
                    <button id="final-gift-btn" onclick="startFireworks()">ğŸ¥¤ æ”¶ä¸‹å…¨ç³–çš„æŠ¹èŒ¶å¥¶èŒ¶</button>
                </div>
                <div class="arrow-up"><svg viewBox="0 0 24 24" fill="#cc7a8b"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></div>
            </div>

            <div class="swiper-slide" id="slide3">
                <div class="safe-container">
                    <div class="galaxy-header">
                        <h2 data-ani="animate__fadeInDown" style="color: var(--text-main); font-size: 1.2rem; font-weight:bold;">ç‚¹äº®å±äºä½ çš„æ˜Ÿç³»</h2>
                        <p id="emo-sub" data-ani="animate__fadeIn" style="font-size: 0.8rem; color: var(--accent-red); margin-top:5px;">ç‚¹å‡»æ°´æ™¶ï¼Œæ”¶é›†çˆ±çš„ç¢ç‰‡</p>
                    </div>
                    <div class="galaxy-wrap" id="galaxy-area">
                        <div class="orbit-ring"></div>
                        <div class="core-planet" data-ani="animate__zoomIn">
                            <img src="img_center.png" id="center-target" alt="Core">
                        </div>
                    </div>
                </div>
                <div class="arrow-up"><svg viewBox="0 0 24 24" fill="#cc7a8b"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></div>
            </div>

            <div class="swiper-slide" id="slide4">
                <div class="safe-container">
                    <div class="glass-card" data-ani="animate__fadeInUp">
                        <div class="img-group">
                            <img src="img_run1.jpg" class="run-img">
                            <img src="img_run2.jpg" class="run-img" style="transform: rotate(4deg);">
                        </div>
                        <h2 style="color: #6a8caf; font-size: 1.1rem; margin-bottom: 10px;">æœªæ¥ï¼Œä¸€èµ·å¥”è·‘</h2>
                        <p style="font-size: 0.9rem; color: #666; line-height: 1.6;">
                            åƒé»‘ç”°æœæ—¥ä¸€æ ·å†²åˆºï¼Œåƒå¤ªç”°è‹ç”Ÿä¸€æ ·çƒ­è¡€ã€‚<br>
                            æˆ‘çŸ¥é“æˆ‘çš„æ¨¾æ¨¾å†…å¿ƒè—ç€å·¨å¤§çš„<strong style="color: var(--accent-red);">ä¸Šè¿›å¿ƒ</strong>ã€‚
                        </p>
                        <p style="font-size: 0.9rem; font-weight: bold; color: var(--text-main); margin-top: 10px;">
                            ä¸ç®¡å‰è·¯å¤šè¿œï¼Œæˆ‘éƒ½åšä½ æœ€åšå®çš„åç›¾ã€‚
                        </p>
                    </div>
                </div>
                <div class="arrow-up"><svg viewBox="0 0 24 24" fill="#cc7a8b"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></div>
            </div>

            <div class="swiper-slide" id="slide-confession">
                <div class="safe-container">
                    <div class="photo-card-wrap" data-ani="animate__zoomIn">
                        <img src="bg_confession.jpg" class="confession-img" alt="Confession">
                        <div style="text-align: center; margin-top: 15px; font-family: 'Noto Serif SC', serif;">
                            <p style="color: var(--accent-red); font-size: 1rem; font-weight: bold;">To å¿—ç€š / æ¨¾æ¨¾</p>
                            <p style="color: #999; font-size: 0.8rem; margin-top: 5px;">â€œå¦‚æœé˜´é›¨ç»µç»µï¼Œé‚£æˆ‘åšä½ çš„æ™´å¤©â€</p>
                        </div>
                    </div>
                </div>
                <div class="arrow-up"><svg viewBox="0 0 24 24" fill="#cc7a8b"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></div>
            </div>

            <div class="swiper-slide" id="slide5">
                <div class="safe-container">
                    <h2 data-ani="animate__fadeInDown" style="font-size: 1.3rem; margin-bottom: 20px; color: var(--text-main);">â™“ ç»™åŒé±¼åº§çš„å¥³å­©</h2>
                    <div class="glass-card" data-ani="animate__zoomInUp" style="padding-bottom: 30px;">
                        <div class="letter-content">
                            <p>äº²çˆ±çš„æ¨¾æ¨¾ï¼š</p>
                            <p>è§å­—å¦‚é¢ã€‚è™½ç„¶æˆ‘ä»¬æ‰åˆšåˆšå¼€å§‹åœ¨ä¸€èµ·ä¸åˆ°åŠä¸ªæœˆï¼Œä½†æˆ‘å¯¹ä½ çš„å–œæ¬¢æ˜¯çœŸçœŸåˆ‡åˆ‡çš„ã€‚ä½ æ´»æ³¼å¯çˆ±ï¼Œæœ‰ä¸Šè¿›å¿ƒï¼Œå¾…äººå‹å–„ï¼Œä¸‰è§‚æ­£ï¼Œå†…å¿ƒæ˜¯ä¸ªéå¸¸å–„è‰¯çš„å°å¥³å­©ï¼</p>
                            <p>é‡è§ä½ çœŸå¥½ã€‚å¸Œæœ›ä½ æ¯å¤©éƒ½è¢«çˆ±ã€ç¾å¥½å’Œå¿«ä¹åŒ…å›´ï¼Œåšä¸€ä¸ªç§¯æå‘ä¸Šçš„å°å…¬ä¸»ã€‚</p>
                            <p>æˆ‘ä¼šä¸€ç›´å®ˆæŠ¤ä½ ã€çˆ±ä½ çš„ï¼</p>
                            <p style="text-align: right; margin-top: 20px; color: var(--accent-red); font-weight: bold;">â€”â€” çˆ±ä½ çš„ç”·æœ‹å‹ é™ˆå¿—ç€š</p>
                        </div>
                        <img src="img_cat.png" class="cat-img" data-ani="animate__bounceIn" alt="Cat">
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div id="fireworks-container"></div>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        // --- Init ---
        window.onload = function() {
            setTimeout(() => {
                const loading = document.getElementById('loading-screen');
                loading.style.opacity = '0';
                setTimeout(() => {
                    loading.style.display = 'none';
                    initSwiper(); 
                }, 500);
            }, 800);
        };

        // --- Swiper Logic ---
        function initSwiper() {
            new Swiper('.swiper-container', {
                direction: 'vertical',
                speed: 600,
                on: {
                    init: function () { playAnimation(this.slides[this.activeIndex]); },
                    slideChangeTransitionEnd: function () { 
                        const current = this.slides[this.activeIndex];
                        playAnimation(current);
                        if(current.id === 'slide2') {
                             const train = document.getElementById('train-wrapper');
                             if(train) {
                                 train.style.transition = 'transform 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 1s';
                                 train.style.opacity = '1';
                                 train.style.transform = 'translateX(0)';
                             }
                        }
                    }
                }
            });
        }

        function playAnimation(slide) {
            slide.querySelectorAll('[data-ani]').forEach(el => {
                el.classList.add('animate__animated', el.getAttribute('data-ani'));
            });
        }

        // --- Interactive (Train) ---
        const cargoData = {
            1: { icon: 'ğŸ§¸', title: 'å¯çˆ±èƒ½é‡', desc: 'æƒ³è¦ç»™æ¨¾æ¨¾ç»‡æˆ‘äº²æ‰‹åšçš„ç©å¶ï¼Œå®ˆæŠ¤ä½ çš„å°‘å¥³å¿ƒï¼' },
            2: { icon: 'ğŸ”', title: 'æ»¡è¶³æ„Ÿç‰¹å¿«', desc: 'å¡”æ–¯æ±€ã€ç‚¸æé²è‡å’Œè—•ç²‰ï¼Œæˆ‘æƒ³åŒ…å…»ä½ çš„èƒƒï¼' },
            3: { icon: 'ğŸ’„', title: 'ç¾ä¸½è¡¥ç»™', desc: 'å£çº¢ï¼Œé¦™æ°´...å®ˆæŠ¤æœ€ç²¾è‡´ã€å®³æ€•é•¿ç—˜çš„æ¨¾æ¨¾ï¼' }
        };
        let openedCount = 0; const openedCarriages = new Set();
        const modal = document.getElementById('cargo-modal');
        const finalBtn = document.getElementById('final-gift-btn');
        const tips = document.getElementById('train-tips');

        window.openCarriage = (id) => {
            const data = cargoData[id];
            document.getElementById('modal-icon').innerText = data.icon;
            document.getElementById('modal-title').innerText = data.title;
            document.getElementById('modal-desc').innerText = data.desc;
            modal.classList.add('show');
            if (!openedCarriages.has(id)) {
                openedCarriages.add(id); openedCount++;
                if(tips) tips.innerText = `å·²æŸ¥æ”¶ (${openedCount}/3)`;
                if (openedCount === 3) setTimeout(() => finalBtn.classList.add('show'), 500);
            }
        };
        window.closeModal = () => modal.classList.remove('show');

        // --- Interactive (Galaxy) ---
        const foods = [
            {i:'ğŸ°', n:'è›‹ç³•', t:'good'}, {i:'ğŸ«', n:'è“è“', t:'good'}, {i:'ğŸ”', n:'æ±‰å ¡', t:'good'}, 
            {i:'ğŸ„', n:'æé²è‡', t:'good'}, {i:'ğŸ¥£', n:'è—•ç²‰', t:'good'}, {i:'ğŸ¥›', n:'ç‰›å¥¶', t:'bad'}, {i:'ğŸŒ¿', n:'é¦™èœ', t:'bad'}
        ];
        const area = document.getElementById('galaxy-area');
        const centerTarget = document.getElementById('center-target');
        const emoSub = document.getElementById('emo-sub');
        const r = 110; 

        if(area) {
            foods.forEach((item, index) => {
                const el = document.createElement('div'); el.className = 'crystal';
                const angle = (index / foods.length) * 2 * Math.PI;
                el.style.left = `calc(50% + ${Math.cos(angle) * r}px - 22px)`;
                el.style.top = `calc(50% + ${Math.sin(angle) * r}px - 22px)`;
                el.innerHTML = `<span>${item.i}</span><p>${item.n}</p>`;
                el.onclick = function() {
                    if(this.classList.contains('clicked')) return;
                    this.classList.add('clicked');
                    if(item.t === 'good') {
                        this.style.opacity = 0; this.style.transform = 'scale(0)';
                        centerTarget.style.transform = 'scale(1.15)'; 
                        setTimeout(() => centerTarget.style.transform = 'scale(1)', 300);
                        emoSub.innerText = "âœ¨ æ”¶é›†äº† " + item.n;
                    } else {
                        this.style.transform = 'scale(1.2)'; this.style.opacity = 0; 
                        emoSub.innerText = "ğŸ›¡ï¸ å·²å¸®ä½ æŒ¡æ‰ " + item.n;
                    }
                };
                area.appendChild(el);
            });
        }

        // --- Common ---
        const startDate = new Date('2026-01-31T00:00:00');
        setInterval(() => {
            const diff = new Date() - startDate;
            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff % 86400000) / 3600000);
            const m = Math.floor((diff % 3600000) / 60000).toString().padStart(2, '0');
            const s = Math.floor((diff % 60000) / 1000).toString().padStart(2, '0');
            const el = document.getElementById('love-timer');
            if(el) el.innerText = `${d}å¤© ${h}æ—¶ ${m}åˆ† ${s}ç§’`;
        }, 1000);

        const bgm = document.getElementById('bgm');
        const musicBtn = document.getElementById('music-control');
        let isPlaying = false;
        
        document.body.addEventListener('touchstart', function() {
            if(!isPlaying) { bgm.play(); isPlaying = true; musicBtn.classList.add('playing'); }
        }, {once:true});

        musicBtn.onclick = () => {
            if(isPlaying) { bgm.pause(); musicBtn.classList.remove('playing'); } 
            else { bgm.play(); musicBtn.classList.add('playing'); }
            isPlaying = !isPlaying;
        };

        window.startFireworks = () => {
            finalBtn.innerText = "ğŸ‰ æƒ…äººèŠ‚å¿«ä¹ï¼"; 
            finalBtn.style.background = "#FFD700";
            const container = document.getElementById('fireworks-container');
            const colors = ['#eec1cd', '#d4a5b0', '#FFD700', '#FF69B4'];
            for(let i=0; i<60; i++) {
                const p = document.createElement('div'); p.className = 'confetti';
                p.style.background = colors[Math.floor(Math.random()*colors.length)];
                p.style.left = '50%'; p.style.top = '70%'; 
                const angle = Math.random() * Math.PI * 2; const dist = 100 + Math.random() * 300;
                p.animate([
                    { transform: 'translate(0,0) scale(1)', opacity: 1 }, 
                    { transform: `translate(${Math.cos(angle) * dist}px, ${Math.sin(angle) * dist}px) scale(0)`, opacity: 0 }
                ], { duration: 1000 + Math.random()*1000, fill: 'forwards' });
                container.appendChild(p);
            }
        };
    </script>
</body>
</html>
